@if (selectedFiles.length < selectedFilesCountMax()) {
<!-- Drag and Drop Area -->
<div class="upload-area"
    *ngIf="selectedFiles.length < selectedFilesCountMax()"
    [class.drag-over]="isDragOver"
    (dragover)="onDragOver($event)"
    (dragleave)="onDragLeave($event)"
    (drop)="onDrop($event)">
    
    <div class="upload-content">
    <mat-icon class="upload-icon">cloud_upload</mat-icon>
    <div class="upload-title">
        @if (selectedFilesCountMax() > 1) {
            Drop files here
        } @else {
            Drop file here
        }
    </div>
    <div class="upload-subtitle">or click Browse files</div>
    <p class="upload-subtitle">
        @if (selectedFilesCountMax() > 1) {
            Support for multiple file types up to 100MB each
        } @else {
            File size up to 100MB supported
        }
    </p>
    
    <button mat-raised-button 
            color="primary" 
            class="browse-button"
            (click)="fileInput.click()">
        <mat-icon>folder_open</mat-icon>
        Browse files
    </button>
    
    <input #fileInput 
            type="file" 
            multiple 
            style="display: none;"
            (change)="onFileSelected($event)">
    </div>
</div>
} @else {
    <!-- empty -->
}

<!-- Selected Files List -->
@if (selectedFiles.length > 0 && !isUploading) {
    <div class="selected-files">
        <div class="files-header">
            @if (selectedFiles.length === 1) {
                <h3>Selected file</h3>
            } @else {
                <h3>Selected files ({{ selectedFiles.length }})</h3>
                <div class="files-summary">
                    <span class="total-size">Total: {{ getTotalSize() }}</span>
                    <button mat-button
                        color="warn"
                        class="clear-all-button"
                        (click)="clearAllFiles()">
                        Clear all
                    </button>
                </div>
            }
        </div>
        <div class="files-list">
            @for (file of selectedFiles; track file.name; let i = $index) {
            <div class="file-item">
                <div class="file-info">
                <mat-icon class="file-icon">{{ getFileIcon(file) }}</mat-icon>
                <div class="file-details">
                    <span class="file-name">{{ file.name }}</span>
                    <span class="file-size">{{ formatFileSize(file.size) }}</span>
                </div>
                </div>
                <button mat-icon-button 
                        color="warn" 
                        class="remove-button"
                        (click)="removeFile(i)"
                        matTooltip="Remove file">
                <mat-icon>close</mat-icon>
                </button>
            </div>
            }
        </div>
    </div>
}

<!-- Upload Progress (when uploading) -->
@if (isUploading) {
    <div class="upload-progress">
    <h3>Uploading files...</h3>
    <mat-progress-bar 
        mode="determinate" 
        [value]="uploadProgress"
        class="progress-bar">
    </mat-progress-bar>
    <p class="progress-text">{{ uploadProgress }}% Complete</p>
    </div>
}
